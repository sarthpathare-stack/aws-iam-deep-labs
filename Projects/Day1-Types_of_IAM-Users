#!/usr/bin/env python3
"""
IAM USER vs ROOT USER COMPARISON
=================================
Shows key differences between IAM User and Root User
"""

import os
import time

def clear_screen():
    """Clear terminal screen"""
    os.system('cls' if os.name == 'nt' else 'clear')

def print_header():
    """Print tool header"""
    print("ğŸ”" * 25)
    print("ğŸ”   IAM USER vs ROOT USER COMPARISON   ğŸ”")
    print("ğŸ”" * 25)
    print()

def animate_text(text, delay=0.03):
    """Animate text printing"""
    for char in text:
        print(char, end='', flush=True)
        time.sleep(delay)
    print()

def show_comparison():
    """Display the comparison table"""
    print("=" * 70)
    print("ğŸ“Š COMPARISON TABLE")
    print("=" * 70)
    print()
    
    # Table data
    features = [
        ["", "IAM USER", "ROOT USER"],
        ["-"*30, "-"*20, "-"*20],
        ["ğŸ” ACCESS TYPE", "Granular permissions", "Full account access"],
        ["ğŸ“ CREATION", "Created by admin/root", "Default account owner"],
        ["ğŸ’° COST", "Free", "Free"],
        ["ğŸ”„ MFA ENFORCEMENT", "Can be enforced", "Can be enabled"],
        ["ğŸ”‘ PASSWORD POLICY", "Follows IAM policy", "No policy (set manually)"],
        ["ğŸ‘¥ MULTIPLE", "Many users possible", "Only one per account"],
        ["ğŸš¨ DELETE ACCOUNT", "âŒ Cannot", "âœ… Can delete AWS account"],
        ["ğŸ’³ BILLING ACCESS", "If granted permission", "âœ… Full billing access"],
        ["ğŸŒ ROUTE 53 DOMAINS", "If granted permission", "âœ… Full access"],
        ["ğŸ”§ IAM MANAGEMENT", "If granted permission", "âœ… Full IAM access"],
        ["ğŸ“ SUPPORT TICKETS", "If granted permission", "âœ… Create all tickets"],
        ["ğŸ·ï¸ RESOURCE TAGS", "Can tag if permitted", "âœ… Tag all resources"],
        ["ğŸ” CREDENTIALS", "Password + Access Keys", "Password + Access Keys"],
        ["ğŸ›¡ï¸ SECURITY", "Follows IAM policies", "Bypasses all policies"],
        ["ğŸ“Š CLOUDTRAIL LOGS", "Individual user logs", "Root user activity logs"],
        ["âš¡ RECOMMENDATION", "âœ… USE FOR DAILY WORK", "ğŸš« USE ONLY WHEN REQUIRED"]
    ]
    
    # Print table
    for row in features:
        print(f"{row[0]:30} | {row[1]:20} | {row[2]:20}")
    
    print()

def show_when_to_use():
    """Show when to use each"""
    print("=" * 70)
    print("ğŸ¯ WHEN TO USE EACH")
    print("=" * 70)
    print()
    
    print("âœ… USE IAM USER FOR:")
    print("-" * 30)
    print("â€¢ Daily administration work")
    print("â€¢ Developer access")
    print("â€¢ CI/CD pipelines")
    print("â€¢ Application access")
    print("â€¢ Team member access")
    print("â€¢ Regular AWS console access")
    print()
    
    print("ğŸš¨ USE ROOT USER ONLY FOR:")
    print("-" * 30)
    print("â€¢ Initial AWS account setup")
    print("â€¢ Changing AWS support plan")
    print("â€¢ Restoring IAM user permissions")
    print("â€¢ Closing AWS account")
    print("â€¢ Changing account settings")
    print("â€¢ Viewing billing information")
    print()

def show_security_checklist():
    """Show security checklist"""
    print("=" * 70)
    print("ğŸ›¡ï¸ SECURITY CHECKLIST")
    print("=" * 70)
    print()
    
    checklist = [
        "ğŸ”’ Enable MFA on Root User (IMPORTANT!)",
        "ğŸ“§ Use separate email for Root User",
        "ğŸ”‘ Delete Root User access keys",
        "ğŸ‘¤ Create IAM admin users for daily work",
        "ğŸ“ Use strong password policies",
        "ğŸ”„ Regularly rotate IAM user credentials",
        "ğŸ“Š Enable CloudTrail logging",
        "ğŸš« Never share Root User credentials",
        "ğŸ“± Use hardware MFA if possible",
        "ğŸ“‹ Review IAM policies regularly"
    ]
    
    for i, item in enumerate(checklist, 1):
        print(f"{i:2}. {item}")
    
    print()

def show_danger_zones():
    """Show dangerous root user actions"""
    print("=" * 70)
    print("âš ï¸  DANGEROUS ROOT USER ACTIONS")
    print("=" * 70)
    print()
    
    dangers = [
        "1. âŒ SHARING root credentials with team members",
        "2. âŒ USING root for daily tasks",
        "3. âŒ STORING root password in plain text",
        "4. âŒ DISABLING MFA on root account",
        "5. âŒ CREATING access keys for root",
        "6. âŒ LOGGING IN from public computers",
        "7. âŒ USING root in automation scripts",
        "8. âŒ IGNORING root login alerts"
    ]
    
    for danger in dangers:
        print(danger)
    
    print()

def show_quick_test():
    """Quick test to check understanding"""
    print("=" * 70)
    print("ğŸ§ª QUICK TEST")
    print("=" * 70)
    print()
    
    questions = [
        {
            "q": "Who can delete an AWS account?",
            "options": ["A) IAM User", "B) Root User", "C) Both", "D) Neither"],
            "answer": "B"
        },
        {
            "q": "Which should you use for daily work?",
            "options": ["A) IAM User", "B) Root User", "C) Either is fine", "D) Neither"],
            "answer": "A"
        },
        {
            "q": "How many root users per AWS account?",
            "options": ["A) 1", "B) 5", "C) Unlimited", "D) 0"],
            "answer": "A"
        }
    ]
    
    score = 0
    for i, q in enumerate(questions, 1):
        print(f"Q{i}. {q['q']}")
        for opt in q['options']:
            print(f"   {opt}")
        
        answer = input("\nYour answer (A/B/C/D): ").upper()
        
        if answer == q['answer']:
            print("âœ… Correct!")
            score += 1
        else:
            print(f"âŒ Wrong! Correct answer: {q['answer']}")
        
        print()
    
    print(f"ğŸ“Š Score: {score}/{len(questions)}")
    
    if score == len(questions):
        print("ğŸ‰ Excellent! You understand IAM vs Root!")
    elif score >= len(questions)//2:
        print("ğŸ‘ Good understanding!")
    else:
        print("ğŸ“š Review the material above!")
    
    print()

def main_menu():
    """Display main menu"""
    clear_screen()
    print_header()
    
    print("ğŸ“š What would you like to see?")
    print()
    print("1. ğŸ“Š Comparison Table")
    print("2. ğŸ¯ When to Use Each")
    print("3. ğŸ›¡ï¸ Security Checklist")
    print("4. âš ï¸ Dangerous Actions")
    print("5. ğŸ§ª Quick Test")
    print("6. ğŸ”„ Show All")
    print("0. ğŸšª Exit")
    print()

def main():
    """Main function"""
    while True:
        main_menu()
        
        choice = input("Enter choice (0-6): ").strip()
        
        clear_screen()
        print_header()
        
        if choice == "1":
            show_comparison()
        elif choice == "2":
            show_when_to_use()
        elif choice == "3":
            show_security_checklist()
        elif choice == "4":
            show_danger_zones()
        elif choice == "5":
            show_quick_test()
        elif choice == "6":
            show_comparison()
            input("\nPress Enter to continue...")
            clear_screen()
            print_header()
            show_when_to_use()
            input("\nPress Enter to continue...")
            clear_screen()
            print_header()
            show_security_checklist()
            input("\nPress Enter to continue...")
            clear_screen()
            print_header()
            show_danger_zones()
            input("\nPress Enter to continue...")
            clear_screen()
            print_header()
            show_quick_test()
        elif choice == "0":
            print("\n" + "=" * 50)
            print("ğŸ‘‹ Stay secure! Use IAM Users for daily work!")
            print("=" * 50)
            break
        else:
            print("âŒ Invalid choice! Please try again.")
            time.sleep(1)
            continue
        
        if choice != "6":  # Don't ask when showing all
            input("\nPress Enter to return to menu...")

def quick_version():
    """Quick one-page version"""
    print("=" * 70)
    print("ğŸ” IAM USER vs ROOT USER - CHEAT SHEET")
    print("=" * 70)
    print()
    
    print("IAM USER (Use this for daily work):")
    print("-" * 40)
    print("â€¢ ğŸ‘¤ Created by admin")
    print("â€¢ ğŸ” Granular permissions")
    print("â€¢ ğŸ†“ Free to create")
    print("â€¢ âœ… Can enforce MFA")
    print("â€¢ âŒ Cannot delete account")
    print()
    
    print("ROOT USER (Use only when needed):")
    print("-" * 40)
    print("â€¢ ğŸ‘‘ Account owner")
    print("â€¢ âš¡ Full access to everything")
    print("â€¢ ğŸ†“ Only one per account")
    print("â€¢ ğŸš¨ Can delete AWS account")
    print("â€¢ ğŸ’³ Full billing access")
    print()
    
    print("ğŸ”´ NEVER DO WITH ROOT USER:")
    print("-" * 40)
    print("1. âŒ Daily work")
    print("2. âŒ Share credentials")
    print("3. âŒ Disable MFA")
    print("4. âŒ Create access keys")
    print()
    
    print("âœ… ALWAYS DO:")
    print("-" * 40)
    print("1. ğŸ”’ Enable MFA on root")
    print("2. ğŸ‘¤ Create IAM admin users")
    print("3. ğŸ“Š Monitor CloudTrail logs")
    print("4. ğŸš« Lock away root credentials")
    print()
    print("=" * 70)

# Run the tool
if __name__ == "__main__":
    clear_screen()
    
    # Ask for version
    print("Choose version:")
    print("1. ğŸ“– Full interactive version")
    print("2. ğŸš€ Quick cheat sheet")
    
    version = input("\nEnter choice (1 or 2): ").strip()
    
    clear_screen()
    
    if version == "1":
        main()
    else:
        quick_version()